<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
  {% for post in posts %}
  <url>
    <loc>{{ post.permalink | uriencode }}</loc>
    {% if post.updated %}
    <lastmod>{{ post.updated.toISOString() }}</lastmod>
    {% elif post.date %}
    <lastmod>{{ post.date.toISOString() }}</lastmod>
    {% endif %}
    <date>{{ post.date }}</date>
    
    {# 使用 CDATA 包裹，这样无论标题里有什么符号都不会报错，也不需要 escape #}
    <title><![CDATA[{{ post.title + ' - ' + config.title }}]]></title>
    
    {# 描述部分同理 #}
    <desc><![CDATA[{{ post.description | default(post.excerpt) | default(post.content) | default(config.description) | striptags | truncate(200, true, '') }}]]></desc>
  </url>
  {% endfor %}
</urlset>